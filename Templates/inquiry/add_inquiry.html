{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <link
    rel="shortcut icon"
    href="{% static 'images/logo.png' %}"
    type="image/x-icon"
  />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Garun </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link
    href="https://nepalidatepicker.sajanmaharjan.com.np/nepali.datepicker/css/nepali.datepicker.v4.0.4.min.css"
    rel="stylesheet"
    type="text/css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
  />

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://nepalidatepicker.sajanmaharjan.com.np/nepali.datepicker/js/nepali.datepicker.v4.0.4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@sbmdkl/nepali-date-converter@2.0.3/dist/@sbmdkl/nepali-date-converter.umd.min.js"></script>

    <style>
      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        box-shadow: none;
      }

      .icon-glow-red:hover {
        filter: drop-shadow(0 0 4px rgba(239, 68, 68, 0.8));
      }

      .icon-glow-blue:hover {
        filter: drop-shadow(0 0 4px rgba(59, 130, 246, 0.8));
      }

      .icon-glow-green:hover {
        filter: drop-shadow(0 0 4px rgba(34, 197, 94, 0.8));
      }

      .icon-glow-yellow:hover {
        filter: drop-shadow(0 0 4px rgba(234, 179, 8, 0.8));
      }

      .icon-glow-purple:hover {
        filter: drop-shadow(0 0 4px rgba(168, 85, 247, 0.8));
      }

      .icon-glow-pink:hover {
        filter: drop-shadow(0 0 4px rgba(236, 72, 153, 0.8));
      }
    </style>
  </head>

  <body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 shadow-lg w-full max-w-2xl">
      <form class="grid grid-cols-2 gap-4" method="POST">
        {% csrf_token %}

        <div class="col-span-1">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-file-list-line mr-2 icon-glow-red"></i>Form No
          </label>
          <input
          required
            type="text"
            name="form_no"
            value="{{next_form_no}}"
            readonly
            class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm py-3 px-4"
          />
        </div>

        {% comment %} <div class="col-span-1">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-calendar-line mr-2 icon-glow-blue"></i>Date
          </label>
          <input
          required
            type="date"
            id="dateField"
            name="date"
            class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm py-3 px-4"
          />
        </div> {% endcomment %}
        <div class="col-span-1 relative">
          <label for="inquiry_date" class="block text-sm font-medium text-gray-700 mb-1"> Date</label>
          <i class="ri-calendar-line absolute left-3 top-9 text-yellow-500"></i>
          <input type="date" id="in_date_eng" name="date"
              class="pl-10 pr-3 py-3 w-full border border-gray-200 focus:outline-none focus:border-gray-200"
              required />
      </div>
      <div class="col-span-1 relative">
          <label for="inquiry_miti" class="block text-sm font-medium text-gray-700 mb-1"> Miti</label>
          <i class="ri-calendar-line absolute left-3 top-9 text-green-500"></i>
          <input type="text" name="miti" id="in_date_nep" 
              class="pl-10 pr-3 py-3 w-full border border-gray-200 focus:outline-none focus:border-gray-200"
              required />
      </div>

        <div class="col-span-1">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-user-line mr-2 icon-glow-green"></i>Customer Name
          </label>
          <input
          required
            type="text"
            name="customer_name"
            class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm py-3 px-4"
            placeholder="Enter Customer Name"
          />
        </div>

        <div class="col-span-1">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-building-line mr-2 icon-glow-yellow"></i>Company Name
          </label>
          <input
          required
            type="text"
            name="company_name"
            class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm py-3 px-4"
            placeholder="Enter Company Name"
          />
        </div>

        <div class="col-span-1">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-phone-line mr-2 icon-glow-purple"></i>Contact Number
          </label>
          <input
          required
            type="tel"
            name="contact_number"
            class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm py-3 px-4"
            placeholder="Enter Contact Number"
          />
        </div>

        <div class="col-span-1">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-map-pin-line mr-2 icon-glow-pink"></i>Address
          </label>
          <input
          required
            type="text"
            name="address"
            class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm py-3 px-4"
            placeholder="Enter Address"
          />
        </div>

        <div class="col-span-2">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-user-received-line mr-2 icon-glow-red"></i>Called
            Received By
          </label>
          <select
          name="called_received_by"
          id="employee"
          class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm py-3 px-4"
          {% if all_employees|length <= 1 %} disabled {% endif %}
      >
          {% for employee in all_employees %}
          <option value="{{ employee.first_name }} {{ employee.last_name }}"
              {% if employee.first_name|add:' '|add:employee.last_name == called_received_by %} selected {% endif %}>
              {{ employee.first_name }} {{ employee.last_name }}
          </option>
          {% endfor %}
      </select>
        </div>

        <div class="col-span-2">
          <label
            class="block text-sm font-medium text-gray-700 flex items-center"
          >
            <i class="ri-chat-1-line mr-2 icon-glow-blue"></i>Remarks
          </label>
          <textarea
          required
            name="remarks"
            rows="3"
            class="mt-1 px-6 py-1 block w-full border-gray-300 shadow-sm focus:border-indigo-500 sm:text-sm"
            placeholder="Write Something About Inquiry"
          ></textarea>
        </div>

        <div class="col-span-2">
          <button
            type="submit"
            class="w-full inline-flex justify-center py-3 px-4 border border-transparent shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
          >
            Submit
          </button>
        </div>
      </form>
    </div>

    <script>
      // Set today's date as the default value for the Cheque Date input
      window.addEventListener('DOMContentLoaded', (event) => {
          const today = new Date();
          const year = today.getFullYear();
          const month = String(today.getMonth() + 1).padStart(2, '0');
          const day = String(today.getDate()).padStart(2, '0');
          const formattedDate = `${year}-${month}-${day}`;
          document.getElementById('chequeDate').value = formattedDate;
      });
  </script>
  <script>
      function openCustomDatePicker(inputId) {
        // Implement date picker opening logic here
        console.log("Opening date picker for", inputId);
      }

      // date-conversion.js

      document.addEventListener("DOMContentLoaded", function () {
        let isSyncing = false;

        // Initialize date synchronization for multiple pairs of dates
        initializeDateSync("in_date_eng", "in_date_nep");
      //  initializeDateSync("date_of_sale_eng", "date_of_sale_nep");
       // initializeDateSync("delivery_date_eng", "delivery_date_nep");

        function initializeDateSync(engDateId, nepDateId) {
          const englishDatePicker = flatpickr(`#${engDateId}`, {
            dateFormat: "Y-m-d",
            onChange: function (selectedDates, dateStr) {
              if (!isSyncing) {
                isSyncing = true;
                loadNepaliDate(dateStr, nepDateId);
                isSyncing = false;
              }
            },
          });

          const nepaliDatePicker = document.getElementById(nepDateId);
          nepaliDatePicker.nepaliDatePicker({
            dateFormat: "YYYY-MM-DD",
            closeOnDateSelect: true,
            onChange: function () {
              if (!isSyncing) {
                isSyncing = true;
                const nepaliDate = nepaliDatePicker.value;
                loadEnglishDate(nepaliDate, engDateId);
                isSyncing = false;
              }
            },
          });

          // Load the current system date on page load
          loadCurrentSystemDate(engDateId, nepDateId);
        }

        function loadCurrentSystemDate(engDateId, nepDateId) {
          const currentDate = new Date();
          const formattedDate = currentDate.toISOString().split("T")[0];
          document.getElementById(engDateId).value = formattedDate;
          loadNepaliDate(formattedDate, nepDateId);
        }

        function loadNepaliDate(englishDate, nepDateId) {
          const { adToBs } = window["@sbmdkl/nepali-date-converter"];
          const bsDate = adToBs(englishDate);
          document.getElementById(nepDateId).value = bsDate;
        }

        function loadEnglishDate(nepaliDate, engDateId) {
          const { bsToAd } = window["@sbmdkl/nepali-date-converter"];
          const adDate = bsToAd(nepaliDate);
          document.getElementById(engDateId).value = adDate;
        }
      });
    </script>
    <script>
      // Set current date
      document.addEventListener("DOMContentLoaded", function () {
        var today = new Date().toISOString().split("T")[0];
        document.getElementById("dateField").value = today;
      });
    </script>
    {% comment %} <script>
        // Function to display alerts for messages
        function showAlert(message) {
            alert(message);
        }

        window.onload = function() {
            // Check if there are any messages to show
            {% if messages %}
                const messages = [
                    {% for message in messages %}
                        "{{ message }}"{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                ];
                messages.forEach(showAlert);
            {% endif %}
        };
    </script> {% endcomment %}
  </body>
</html>
